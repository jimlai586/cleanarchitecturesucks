<!DOCTYPE html><html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><title>Let’s destroy some MVVM+C</title><style>
      * {
        font-family: Georgia, Cambria, "Times New Roman", Times, serif;
      }
      html, body {
        margin: 0;
        padding: 0;
      }
      h1 {
        font-size: 50px;
        margin-bottom: 17px;
        color: #333;
      }
      h2 {
        font-size: 24px;
        line-height: 1.6;
        margin: 30px 0 0 0;
        margin-bottom: 18px;
        margin-top: 33px;
        color: #333;
      }
      h3 {
        font-size: 30px;
        margin: 10px 0 20px 0;
        color: #333;
      }
      header {
        width: 640px;
        margin: auto;
      }
      section {
        width: 640px;
        margin: auto;
      }
      section p {
        margin-bottom: 27px;
        font-size: 20px;
        line-height: 1.6;
        color: #333;
      }
      section img {
        max-width: 640px;
      }
      footer {
        padding: 0 20px;
        margin: 50px 0;
        text-align: center;
        font-size: 12px;
      }
      .aspectRatioPlaceholder {
        max-width: auto !important;
        max-height: auto !important;
      }
      .aspectRatioPlaceholder-fill {
        padding-bottom: 0 !important;
      }
      header,
      section[data-field=subtitle],
      section[data-field=description] {
        display: none;
      }
      </style></head><body><article class="h-entry">
<header>
<h1 class="p-name">Let’s destroy some MVVM+C</h1>
</header>
<section data-field="subtitle" class="p-summary">
Why you should not blindly follow guides with big words
</section>
<section data-field="body" class="e-content">
<section name="0064" class="section section--body section--first section--last"><div class="section-divider"><hr class="section-divider"></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><h3 name="6322" id="6322" class="graf graf--h3 graf--leading graf--title">Let’s destroy some MVVM+C</h3><p name="af69" id="af69" class="graf graf--p graf-after--h3">Why you should not blindly follow guides with big words</p><figure name="abfd" id="abfd" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*HKdMX8xmMhT-ypcxA2sKZQ.jpeg" data-width="300" data-height="168" src="https://cdn-images-1.medium.com/max/800/1*HKdMX8xmMhT-ypcxA2sKZQ.jpeg"><figcaption class="imageCaption">It’s Judgement day</figcaption></figure><h4 name="eb89" id="eb89" class="graf graf--h4 graf-after--figure">The problem</h4><p name="7736" id="7736" class="graf graf--p graf-after--h4">Came across this <a href="https://medium.com/@stevenpcurtis.sc/mvvm-c-architecture-with-dependency-injection-testing-3b7197eb2e4d" data-href="https://medium.com/@stevenpcurtis.sc/mvvm-c-architecture-with-dependency-injection-testing-3b7197eb2e4d" class="markup--anchor markup--p-anchor" target="_blank">gem </a>today, in which it claims:</p><blockquote name="4edc" id="4edc" class="graf graf--blockquote graf-after--p">MVVM-C helps with separation of concerns, and allows testing and implementation to be…much better than <a href="https://medium.com/swift-coding/mvc-in-swift-a9b1121ab6f0" data-href="https://medium.com/swift-coding/mvc-in-swift-a9b1121ab6f0" class="markup--anchor markup--blockquote-anchor" rel="noopener" target="_blank">MVC</a></blockquote><p name="a469" id="a469" class="graf graf--p graf-after--blockquote">Oh, is it now?</p><p name="5f52" id="5f52" class="graf graf--p graf-after--p">What makes you think you can’t have separation of concern in MVC?</p><p name="8a3f" id="8a3f" class="graf graf--p graf-after--p">Oh that’s right, because you have to invent a lot of smaller units with more specific responsibilities.</p><p name="ebf3" id="ebf3" class="graf graf--p graf-after--p">I’m going to give you the benefit of doubt, and see how you implement it.</p><blockquote name="35df" id="35df" class="graf graf--blockquote graf-after--p">The coordinator has the following responsibilities:</blockquote><blockquote name="fe38" id="fe38" class="graf graf--blockquote graf-after--blockquote">Initialize the network service</blockquote><blockquote name="62e2" id="62e2" class="graf graf--blockquote graf-after--blockquote">Perform network calls</blockquote><blockquote name="87fb" id="87fb" class="graf graf--blockquote graf-after--blockquote">Initialize the ViewModel with the fetched data (or instruct the ViewModel to handle a failed network call)</blockquote><figure name="6f06" id="6f06" class="graf graf--figure graf-after--blockquote"><img class="graf-image" data-image-id="1*I6d2nYMapiKUMf1-4Sdf-w.jpeg" data-width="300" data-height="210" data-is-featured="true" src="https://cdn-images-1.medium.com/max/800/1*I6d2nYMapiKUMf1-4Sdf-w.jpeg"><figcaption class="imageCaption">So your coordinator is a network service…?</figcaption></figure><p name="1ab2" id="1ab2" class="graf graf--p graf-after--figure">Huh? Why not have a dedicated network service?</p><p name="8153" id="8153" class="graf graf--p graf-after--p">This is the #1 problem in all MVVM implementation. They never bother refactoring out networking to a dedicated service. In fact they complicate it, and ask you to just repeat the same shit.</p><p name="fb58" id="fb58" class="graf graf--p graf-after--p">If you check out the dude’s view model. You need to pass in a coordinator and a http manager in init. The coordinator is never used in the view model, and http manager is used to initiate remote fetch call.</p><p name="7df0" id="7df0" class="graf graf--p graf-after--p">You may want to do separation of concerns, but the fact is that you couple coordinator, view model, and http manager together, and you need to do it for EVERY view model manually.</p><p name="2923" id="2923" class="graf graf--p graf-after--p">A sensible design in MVC with dedicated network service would look like this</p><p name="3221" id="3221" class="graf graf--p graf-after--p"><code class="markup--code markup--p-code">var json = Json(&quot;URL&quot;){didSet {updateView()}}</code></p><p name="1eab" id="1eab" class="graf graf--p graf-after--p"><code class="markup--code markup--p-code">// … json.fetch(params)</code></p><p name="73af" id="73af" class="graf graf--p graf-after--p">See the difference?</p><p name="3cdf" id="3cdf" class="graf graf--p graf-after--p">You don’t need to coordinate SHIT!!!</p><p name="cfcb" id="cfcb" class="graf graf--p graf-after--p">You don’t need to pass REFERENCE TYPE OBJECTS around like GOD DAMN COOKIES!!!</p><p name="787f" id="787f" class="graf graf--p graf-after--p">That is not to say coordinator has no use in MVC. It does. And with some skill you can make it feel natural with almost no overheads. You don’t need to inject it EVERYWHERE to remind people of using it.</p><p name="3665" id="3665" class="graf graf--p graf-after--p">This is the #2 problem in all MVVM implementation. They have to inject everything.</p><p name="5cf5" id="5cf5" class="graf graf--p graf-after--p">Take this dude for example, to create a view controller, you need a coordinator and a view model injected into it during init. To create a view model you need a coordinator and a http manager injected into it.</p><p name="e6b9" id="e6b9" class="graf graf--p graf-after--p">To help you inject all these shit, we need a factory class (not final class, not struct, not static )to do it. To be more general (which you don’t always need), we need a protocol for all factory to follow. Then to be truly general, we need an abstract protocol on top of it. Then to be ultimately general, we need to call factory method to build a coordinator for us first, then we call another factory method with the coordinator as argument to generate view model.</p><p name="3596" id="3596" class="graf graf--p graf-after--p">And we need to repeat this process every time.</p><p name="a17d" id="a17d" class="graf graf--p graf-after--p"><strong class="markup--strong markup--p-strong">But at least we dependency-injected everything, right?</strong></p><p name="d65c" id="d65c" class="graf graf--p graf-after--p">Yes, but actually no.</p><p name="9aeb" id="9aeb" class="graf graf--p graf-after--p">You know how I create a view controller?</p><p name="8910" id="8910" class="graf graf--p graf-after--p"><code class="markup--code markup--p-code">let vc = newVC()</code></p><p name="9e56" id="9e56" class="graf graf--p graf-after--p">How it manages its own view or interacts with coordinator is <strong class="markup--strong markup--p-strong">encapsulated</strong>.</p><p name="3162" id="3162" class="graf graf--p graf-after--p">I call whatever your API (be it protocol, document, public properties … etc) provides me. Why do you think I want to mess around with your implementation detail?</p><p name="fa0c" id="fa0c" class="graf graf--p graf-after--p">By enforcing this injection design, I’m forced to create a view model object that I don’t know how to create. You then have to design more mechanisms to abstract it away.</p><p name="d52a" id="d52a" class="graf graf--p graf-after--p">It now becomes complex and tedious. You are also exposing view model as a reference that I can pass around or capture. I could easily mutate its internal state without you knowing.</p><p name="06ee" id="06ee" class="graf graf--p graf-after--p">Having “separation of concerns” does not give you a free pass. How you implement it is important.</p><p name="6e99" id="6e99" class="graf graf--p graf-after--p">What I’m observing is that, people like to dump stupid shit online for virtue singling points. Dependency injection means jack shit when it’s crushed by its own induced weights.</p><p name="8cca" id="8cca" class="graf graf--p graf-after--p">If a MVVM + C can have this many problems, what do you think a RxSwift + MVVM + C would have?</p><p name="a6e3" id="a6e3" class="graf graf--p graf-after--p">May I present you…</p><h4 name="7c0d" id="7c0d" class="graf graf--h4 graf-after--p">The pinnacle of stupidity</h4><p name="b43e" id="b43e" class="graf graf--p graf-after--h4">This is an example of RxSwift + MVVM + C.</p><div name="cd23" id="cd23" class="graf graf--mixtapeEmbed graf-after--p"><a href="https://medium.com/better-programming/mvvm-in-swift-infinite-scrolling-and-image-loading-d47780b06e23" data-href="https://medium.com/better-programming/mvvm-in-swift-infinite-scrolling-and-image-loading-d47780b06e23" class="markup--anchor markup--mixtapeEmbed-anchor" title="https://medium.com/better-programming/mvvm-in-swift-infinite-scrolling-and-image-loading-d47780b06e23"><strong class="markup--strong markup--mixtapeEmbed-strong">Implement a Reactive MVVM Architecture in Swift 5</strong><br><em class="markup--em markup--mixtapeEmbed-em">We provide three dependencies for the PhotosViewModel: UnsplashPhotosService: Fetches an array of UnsplashPhoto models…</em>medium.com</a><a href="https://medium.com/better-programming/mvvm-in-swift-infinite-scrolling-and-image-loading-d47780b06e23" class="js-mixtapeImage mixtapeImage u-ignoreBlock" data-media-id="1e3bdea7d79c8d89517672ee2da1c6d7" data-thumbnail-img-id="0*sz0x3Tel6hNqmGTR" style="background-image: url(https://cdn-images-1.medium.com/fit/c/160/160/0*sz0x3Tel6hNqmGTR);"></a></div><p name="1c09" id="1c09" class="graf graf--p graf-after--mixtapeEmbed">I hope you can see it, since I’m blocked by this dude. (by trashing RxSwift of course)</p><p name="1348" id="1348" class="graf graf--p graf-after--p">Obviously by adopting MVVM, it contains all the problems of MVVM. RxSwift helps a bit with binding, but hurts a lot more with its extra complexity.</p><p name="8c69" id="8c69" class="graf graf--p graf-after--p">The rule of thumb is this:</p><ol class="postList"><li name="bf0a" id="bf0a" class="graf graf--li graf-after--p">If you include RxSwift, it means you have no respect for official SDK, and have no problems forcing your colleagues to learn it. Maintainability means jack shit to you.</li><li name="c154" id="c154" class="graf graf--li graf-after--li">If you think MVVM actually solves anything, that means you write shit code in MVC, has poor to none refactor skill, and try to use MVVM as a cover so your code doesn’t seem that shit by comparison. Because MVVM forces you to write shit by design.</li><li name="601d" id="601d" class="graf graf--li graf-after--li">If you need to introduce Coordinator like it’s a skill accomplishment, that means you didn’t know how to do dependency injection in the first place, and is so shit at learning it, a rigid, hard-coded design is the best you can come up with to help you do dependency injection. You also have no problems whatsoever shoving this down to other devs’ throat.</li><li name="5fdf" id="5fdf" class="graf graf--li graf-after--li">Combining all above 3 characteristics, you reach the pinnacle of stupidity. You now stand above everyone, using frameworks created by other people, and can finally claim victory over MVC:</li></ol><blockquote name="834f" id="834f" class="graf graf--blockquote graf-after--li">MVVM-C helps with separation of concerns, and allows testing and implementation to be…much better than <a href="https://medium.com/swift-coding/mvc-in-swift-a9b1121ab6f0" data-href="https://medium.com/swift-coding/mvc-in-swift-a9b1121ab6f0" class="markup--anchor markup--blockquote-anchor" rel="noopener" target="_blank">MVC</a></blockquote><p name="f80b" id="f80b" class="graf graf--p graf-after--blockquote">Now, let’s tear this shit apart.</p><h4 name="a8a2" id="a8a2" class="graf graf--h4 graf-after--p">Tear this shit apart</h4><blockquote name="0e40" id="0e40" class="graf graf--blockquote graf-after--h4"><strong class="markup--strong markup--blockquote-strong">Business Logic Layer: </strong>Consists of a model and services. The <code class="markup--code markup--blockquote-code">UnsplashPhoto</code> struct acts as a model and represents a particular photo we retrieve from the API. We use services to implement a certain business logic — e.g., f<strong class="markup--strong markup--blockquote-strong">etching a list of Unsplash photos and loading data from the internet.</strong></blockquote><p name="2974" id="2974" class="graf graf--p graf-after--blockquote">See? MVVM devs never bother refactoring out networking. You want to decouple networking, not coupling it with everything…</p><pre name="117a" id="117a" class="graf graf--pre graf-after--p">let photosViewController = PhotosViewController() <br>let photosViewModel = PhotosViewModelImplementation( photosService: UnsplashPhotosServiceImplementation(), photoLoadingService: DataLoadingServiceImplementation(), dataToImageService: DataToImageConversionServiceImplementation(), coordinator: self )<br>photosViewController.viewModel = photosViewModel</pre><p name="4148" id="4148" class="graf graf--p graf-after--pre">MVVM creates this illusion that everything is modular, testable, and reusable.</p><p name="23d5" id="23d5" class="graf graf--p graf-after--p">Let’s look at this from another perspective.</p><p name="02d8" id="02d8" class="graf graf--p graf-after--p">Do you have a choice to swap out <code class="markup--code markup--p-code">photosViewModel</code> for<code class="markup--code markup--p-code">photosViewController</code>?</p><p name="c291" id="c291" class="graf graf--p graf-after--p">Yes, as long as you conform to protocol.</p><p name="f4b9" id="f4b9" class="graf graf--p graf-after--p">OK. So of all the parameters I need to pass in to create an <code class="markup--code markup--p-code">photosViewModel</code> , do I have a choice to swap any of them?</p><p name="ff6d" id="ff6d" class="graf graf--p graf-after--p">Yes, as long as you conform to protocol.</p><p name="ea81" id="ea81" class="graf graf--p graf-after--p">But what if I have no need of customizing any of these default behaviors?</p><p name="c2f8" id="c2f8" class="graf graf--p graf-after--p">You might. You just don’t know yet.</p><p name="9b2f" id="9b2f" class="graf graf--p graf-after--p">So you are fucking me with all these retarded initialization, extra protocols, services, view model types to have a worthless over-generalization for a <em class="markup--em markup--p-em">maybe</em>?</p><p name="4864" id="4864" class="graf graf--p graf-after--p">Yes. Because it’s easier to test, reuse, … etc this way.</p><p name="2472" id="2472" class="graf graf--p graf-after--p"><strong class="markup--strong markup--p-strong">No, there are other ways. You are just too dumb to implement it because you write shit MVC. Relying on other peoples’ work makes you weak.</strong></p><p name="ffb8" id="ffb8" class="graf graf--p graf-after--p"><strong class="markup--strong markup--p-strong">Encapsulate your shit. If your shit has 10 moving parts, I don’t want to know. Simplify your shit so I can easily call your shit to do shit. Other than that it’s your shit.</strong></p><p name="4b46" id="4b46" class="graf graf--p graf-after--p">For those who are interested, you can count how many types are created just for this. And the responsibility of creating them are left to the unfortunate developer that has to maintain this shit. That is just one view model.</p><p name="1326" id="1326" class="graf graf--p graf-after--p">So what about MVC? Aren’t you just going to put everything in view controller?</p><p name="cdcb" id="cdcb" class="graf graf--p graf-after--p">You must be reading codes from a shity developer. Here’s what a pro gamer would do.</p><p name="da41" id="da41" class="graf graf--p graf-after--p">Note that all those services passed to view model are to do one thing:</p><p name="51ec" id="51ec" class="graf graf--p graf-after--p"><em class="markup--em markup--p-em">fetch some photo and convert it to proper format.</em></p><p name="3620" id="3620" class="graf graf--p graf-after--p">A hot shot MVVM developer requires 3 sets of protocol-class-object to do this ?</p><p name="ab3e" id="ab3e" class="graf graf--p graf-after--p">LMAO. This is a possible alternative:</p><p name="37e3" id="37e3" class="graf graf--p graf-after--p"><code class="markup--code markup--p-code">var res = Resource(&quot;URL&quot;){ didSet { convert()// update photo}}</code></p><p name="ce5d" id="ce5d" class="graf graf--p graf-after--p"><code class="markup--code markup--p-code">var photo: UIImage? { didSet { updateUI() }}</code></p><p name="3f62" id="3f62" class="graf graf--p graf-after--p"><code class="markup--code markup--p-code">res.fetch(params)</code></p><p name="2cbd" id="2cbd" class="graf graf--p graf-after--p">Resource would be some pre-defined type dedicated to handle networking. You don’t couple networking with view model or business logic. You <em class="markup--em markup--p-em">decouple </em>it.</p><p name="dc4f" id="dc4f" class="graf graf--p graf-after--p">Resource type would be part of the library whose test is separated from application codes.</p><p name="e14a" id="e14a" class="graf graf--p graf-after--p">By comparison you can see how much boilerplate MVVM forces upon you. If you don’t have 10 moving parts, then you don’t need to test 10 moving parts.</p><p name="4b6b" id="4b6b" class="graf graf--p graf-after--p">On the other hand, if I were to have 10 moving parts, they would be refactored nicely, and they would not be exposed to some sucker who has to figure out how to create 10 objects to pass in as arguments.</p><p name="9665" id="9665" class="graf graf--p graf-after--p">This is why any developer worth their salt would refactor out networking.</p><h4 name="6206" id="6206" class="graf graf--h4 graf-after--p">RxSwift nonsense</h4><p name="1692" id="1692" class="graf graf--p graf-after--h4">Since we’ve established that MVVM devs don’t know jack shit about refactoring. It makes perfect sense that they need some external tool to save face. How else are they going to cope with the mess from all the boilerplate objects they created?</p><p name="8c0f" id="8c0f" class="graf graf--p graf-after--p">Take callback for example. Without RxSwift, they have to pass or capture view controller reference to pull the kind of shit MVVM is supposed to pull. e.g.; binding.</p><p name="ac12" id="ac12" class="graf graf--p graf-after--p">They will look bad. So obviously they will talk shit about callback or delegates being messy and tedious to setup. That’s cute coming from devs that need 3 services to fetch a photo.</p><p name="9643" id="9643" class="graf graf--p graf-after--p">On the other hand, Rx wants to sell products, so these two quickly collude together. Together they acted like they are the salvation for large projects. And hot shot like this dude could act all high and mighty.</p><p name="129b" id="129b" class="graf graf--p graf-after--p">They are not.</p><p name="f999" id="f999" class="graf graf--p graf-after--p">The simple fact is that, if you need 3+ services for a remote fetch, for each view model. You are going to need RxSwift otherwise you look stupid.</p><p name="a922" id="a922" class="graf graf--p graf-after--p">If you only need 3 lines, property observer is more than enough.</p><p name="348d" id="348d" class="graf graf--p graf-after--p">Throw in some retarded RxSwift shit for amusement below: (only look at PhotoDetailViewModelImplementation)</p><ol class="postList"><li name="1dc1" id="1dc1" class="graf graf--li graf-after--p">bindOnViewDidLoad is retarded</li></ol><p name="63d9" id="63d9" class="graf graf--p graf-after--li">All you need is a callback from fetch. update view, prepare model (can be value type instead of reference type view model btw) in callback.</p><p name="2a9c" id="2a9c" class="graf graf--p graf-after--p">2. RxRelay is retarded</p><p name="ac9d" id="ac9d" class="graf graf--p graf-after--p">Can be replaced by callback + property observer. And what’s with yet another dependency? You are just going to shove it down your colleagues’ throat like you always did?</p><p name="e6b6" id="e6b6" class="graf graf--p graf-after--p">3. disposed(by: disposeBag) is retarded</p><p name="21fc" id="21fc" class="graf graf--p graf-after--p">Let me get this straight. RxSwift wants you to do manual memory management, and makes you think this is a brilliant idea?</p><p name="bc26" id="bc26" class="graf graf--p graf-after--p">4. multiple unsplashPhoto binding is retarded</p><p name="eaf6" id="eaf6" class="graf graf--p graf-after--p">Use property observer to prepare any shit you need, then use it to update UI.</p><p name="5de8" id="5de8" class="graf graf--p graf-after--p">Not to mention view model itself is redundantly retarded.</p><h4 name="0fa2" id="0fa2" class="graf graf--h4 graf-after--p">Conclusion</h4><p name="da57" id="da57" class="graf graf--p graf-after--h4">If you read through all this rant, I hope you’ve realized that you should not blindly follow guides with big words.</p><p name="8fd2" id="8fd2" class="graf graf--p graf-after--p graf--trailing">Learn to walk before you run. MVC is the foundation. If you write shit in MVC, you write shit everywhere else.</p></div></div></section>
</section>
<footer><p>By <a href="https://medium.com/@swift2931" class="p-author h-card">Jim Lai</a> on <a href="https://medium.com/p/8a431c07dc9b"><time class="dt-published" datetime="2020-07-21T16:07:54.627Z">July 21, 2020</time></a>.</p><p><a href="https://medium.com/@swift2931/lets-destroy-some-mvvm-c-8a431c07dc9b" class="p-canonical">Canonical link</a></p><p>Exported from <a href="https://medium.com">Medium</a> on December 9, 2023.</p></footer></article></body></html>