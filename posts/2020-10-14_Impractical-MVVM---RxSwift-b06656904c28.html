<!DOCTYPE html><html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><title>Impractical MVVM + RxSwift</title><style>
      * {
        font-family: Georgia, Cambria, "Times New Roman", Times, serif;
      }
      html, body {
        margin: 0;
        padding: 0;
      }
      h1 {
        font-size: 50px;
        margin-bottom: 17px;
        color: #333;
      }
      h2 {
        font-size: 24px;
        line-height: 1.6;
        margin: 30px 0 0 0;
        margin-bottom: 18px;
        margin-top: 33px;
        color: #333;
      }
      h3 {
        font-size: 30px;
        margin: 10px 0 20px 0;
        color: #333;
      }
      header {
        width: 640px;
        margin: auto;
      }
      section {
        width: 640px;
        margin: auto;
      }
      section p {
        margin-bottom: 27px;
        font-size: 20px;
        line-height: 1.6;
        color: #333;
      }
      section img {
        max-width: 640px;
      }
      footer {
        padding: 0 20px;
        margin: 50px 0;
        text-align: center;
        font-size: 12px;
      }
      .aspectRatioPlaceholder {
        max-width: auto !important;
        max-height: auto !important;
      }
      .aspectRatioPlaceholder-fill {
        padding-bottom: 0 !important;
      }
      header,
      section[data-field=subtitle],
      section[data-field=description] {
        display: none;
      }
      </style></head><body><article class="h-entry">
<header>
<h1 class="p-name">Impractical MVVM + RxSwift</h1>
</header>
<section data-field="subtitle" class="p-summary">
An introduction to Property Observer Programming
</section>
<section data-field="body" class="e-content">
<section name="32e6" class="section section--body section--first section--last"><div class="section-divider"><hr class="section-divider"></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><h3 name="d56f" id="d56f" class="graf graf--h3 graf--leading graf--title">Impractical MVVM + RxSwift</h3><p name="18e6" id="18e6" class="graf graf--p graf-after--h3">An introduction to Property Observer Programming</p><figure name="1663" id="1663" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*75AcHAPAttLM4VWOC-3wyA.png" data-width="620" data-height="420" data-is-featured="true" src="https://cdn-images-1.medium.com/max/800/1*75AcHAPAttLM4VWOC-3wyA.png"><figcaption class="imageCaption">Me, after watching MVVM+RxSwift</figcaption></figure><h4 name="5a7c" id="5a7c" class="graf graf--h4 graf-after--figure">Hauntingly Beautiful</h4><p name="1706" id="1706" class="graf graf--p graf-after--h4">Let’s start by appreciating what a great show<em class="markup--em markup--p-em"> the haunting of bly manor</em> is.</p><p name="af9f" id="af9f" class="graf graf--p graf-after--p">Some people think its pacing is too slow and not scary at all. But I think the part it does right, it does <em class="markup--em markup--p-em">very right</em>. And that ending, oh how it broke me…</p><p name="d8da" id="d8da" class="graf graf--p graf-after--p">Back to the topic, let’s code review another victim of applying Android programming to iOS: <a href="https://medium.com/flawless-app-stories/practical-mvvm-rxswift-a330db6aa693" data-href="https://medium.com/flawless-app-stories/practical-mvvm-rxswift-a330db6aa693" class="markup--anchor markup--p-anchor" target="_blank">“Practical MVVM + RxSwift”</a></p><h4 name="9e5d" id="9e5d" class="graf graf--h4 graf-after--p">MVVM makes you do some really stupid shit</h4><figure name="0242" id="0242" class="graf graf--figure graf-after--h4"><img class="graf-image" data-image-id="1*KSc58eQx140qhiVT58mbcw.jpeg" data-width="476" data-height="482" src="https://cdn-images-1.medium.com/max/800/1*KSc58eQx140qhiVT58mbcw.jpeg"></figure><p name="f63a" id="f63a" class="graf graf--p graf-after--figure">It always goes down this way:</p><ol class="postList"><li name="e908" id="e908" class="graf graf--li graf-after--p">Heard from somewhere (probably Android) that MVVM is godlike, solves massive view controller problem… etc.</li><li name="f283" id="f283" class="graf graf--li graf-after--li">Try to do it in UIKit</li><li name="8037" id="8037" class="graf graf--li graf-after--li">Ignore the fact that UIKit has binding mechanism, proceed to manually create binding for every view model</li><li name="b259" id="b259" class="graf graf--li graf-after--li">Introduce some external dependency to make yourself look less stupid</li><li name="5fa7" id="5fa7" class="graf graf--li graf-after--li">Write tons of glue code, pollute stacktrace, split into many smaller objects, over-generalize / over-complicate things</li><li name="9748" id="9748" class="graf graf--li graf-after--li">Claim victory without proof or comparison</li><li name="0119" id="0119" class="graf graf--li graf-after--li">Profit from selling above tutorials</li></ol><p name="8560" id="8560" class="graf graf--p graf-after--li">Let’s make one thing clear first:</p><p name="28f6" id="28f6" class="graf graf--p graf-after--p"><strong class="markup--strong markup--p-strong">MVVM in java sense does not work in iOS. And MVVM is not without its problems.</strong></p><p name="eca3" id="eca3" class="graf graf--p graf-after--p">And as usual, no MVVM related tutorials would tell you that, you need to search with keywords like <em class="markup--em markup--p-em">“why MVVM is shit”</em>.</p><p name="5713" id="5713" class="graf graf--p graf-after--p">The linked article introduces RxSwift to accompany MVVM for this:</p><figure name="7908" id="7908" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*IAYJBqzurmHikH5BNaCSnw.png" data-width="1112" data-height="116" src="https://cdn-images-1.medium.com/max/800/1*IAYJBqzurmHikH5BNaCSnw.png"></figure><p name="0d98" id="0d98" class="graf graf--p graf-after--figure">Let’s avoid the usual pitfall that goes into FRP, i.e.; you need to learn observable and lots of other background knowledge. It’s a trap because it distracts you from the real important question:</p><p name="4fa6" id="4fa6" class="graf graf--p graf-after--p"><strong class="markup--strong markup--p-strong">What problem are you trying to solve and what alternative have you considered?</strong></p><p name="50d7" id="50d7" class="graf graf--p graf-after--p">Of course the tutorial won’t give you the reasons to NOT follow the tutorial, so this leads to a lot of dumb shit developers recklessly applying shits they read on the internet to production code.</p><p name="1128" id="1128" class="graf graf--p graf-after--p">In this case, the author introduces a complex third-party library (RxSwift) to observe some shit.</p><p name="9786" id="9786" class="graf graf--p graf-after--p"><strong class="markup--strong markup--p-strong">Why do we need to observe some shit?</strong></p><p name="7ff8" id="7ff8" class="graf graf--p graf-after--p">Because we defined a loading event, duh.</p><p name="1d8b" id="1d8b" class="graf graf--p graf-after--p"><strong class="markup--strong markup--p-strong">So why do we need to define a loading event?</strong></p><p name="c392" id="c392" class="graf graf--p graf-after--p">So we can observe and react to it, duh. This is Reactive programming.</p><p name="d5ce" id="d5ce" class="graf graf--p graf-after--p"><strong class="markup--strong markup--p-strong">I see, but as a comparison, what does it look like to write it in old-fashioned way?</strong></p><pre name="3926" id="3926" class="graf graf--pre graf-after--p"><strong class="markup--strong markup--pre-strong">var isLoading: Bool {didSet {startAnimating()} }</strong></pre><p name="d1e8" id="d1e8" class="graf graf--p graf-after--pre"><strong class="markup--strong markup--p-strong">…</strong></p><p name="bcc9" id="bcc9" class="graf graf--p graf-after--p"><strong class="markup--strong markup--p-strong">…</strong></p><p name="2668" id="2668" class="graf graf--p graf-after--p"><strong class="markup--strong markup--p-strong">Why do we need to observe some shit again?</strong></p><p name="f859" id="f859" class="graf graf--p graf-after--p">Because MVVM. Because you moved a model with state outside of view controller. Because you were told there would be benefits.</p><p name="82e3" id="82e3" class="graf graf--p graf-after--p">If there were no property observer, then this might be the case.</p><p name="0aaf" id="0aaf" class="graf graf--p graf-after--p">But there were. And as the result, you would see use cases where MVVM + RxSwift getting destroyed by a single language feature.</p><p name="77b2" id="77b2" class="graf graf--p graf-after--p"><strong class="markup--strong markup--p-strong">Property observer is the single most underestimated and overlooked feature of Swift.</strong></p><p name="8fb2" id="8fb2" class="graf graf--p graf-after--p">No MVVM or RxSwift tutorial would mention it. Why would they? This shit sells tutorials.</p><p name="82f1" id="82f1" class="graf graf--p graf-after--p">The most frequent thing I’ve heard people talking about RxSwift is how high an entry threshold it has. Well, then it better be so smart that it writes itself, otherwise what’s the point?</p><p name="a603" id="a603" class="graf graf--p graf-after--p">But we can see from above example, it got destroyed by a property observer. A fucking property observer. And use cases like that take up 90% of RxSwift use cases in my estimate.</p><p name="16e3" id="16e3" class="graf graf--p graf-after--p">So you are using a complex library to do simple things (RxCocoa also replaces official SDK) most of the time and you gloat about thinking you are a hot shot.</p><figure name="eba4" id="eba4" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*hmBlRn04F2GBD21JTcmstw.jpeg" data-width="275" data-height="183" src="https://cdn-images-1.medium.com/max/800/1*hmBlRn04F2GBD21JTcmstw.jpeg"></figure><p name="32fa" id="32fa" class="graf graf--p graf-after--figure">People think MVVM + RxSwift combines the best of both worlds:</p><p name="1b32" id="1b32" class="graf graf--p graf-after--p">Use RxSwift to overcome the lack of binding in iOS, so you can have MVVM with much fewer overheads.</p><p name="3951" id="3951" class="graf graf--p graf-after--p">It is in fact the <strong class="markup--strong markup--p-strong">worst </strong>of both worlds:</p><p name="8a7e" id="8a7e" class="graf graf--p graf-after--p">You now have moronic MVVM architecture which is an ambiguous mess (wtf is even a view model?) with RxSwift which is an over-engineering of epic proportions (most of the time you just need a callback without event or observing any shit).</p><p name="3b9f" id="3b9f" class="graf graf--p graf-after--p">And the best part? When you finally pull through all the background knowledge and overheads implementing MVVM + RxSwift, you immediately get destroyed by a simple use of property observer.</p><p name="f36c" id="f36c" class="graf graf--p graf-after--p">I haven’t even got to Protocol Oriented Programming, which not surprisingly, is not mentioned anywhere in MVVM or RxSwift tutorials. If you think you can’t write clean code without external object like view models, you are gravely mistaken. It’s far easier to do composition by functions rather than composition by objects.</p><p name="106e" id="106e" class="graf graf--p graf-after--p">If there’s any shit you should be observing, you should observe the paradigm shift that is Swift. POP, property observer, value type, to name a few. You should discard any tutorials without these keywords from now on instead of holding on out-of-date implementation without unique language features.</p><p name="180c" id="180c" class="graf graf--p graf-after--p">As another example, let’s see how property observer impacts MVVM.</p><p name="277f" id="277f" class="graf graf--p graf-after--p">Take a look at the iconic MVVM architecture as outlined in the linked article:</p><figure name="ba20" id="ba20" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*8elImtR1Mr51oGhfGcQGvw.png" data-width="1152" data-height="986" src="https://cdn-images-1.medium.com/max/800/1*8elImtR1Mr51oGhfGcQGvw.png"></figure><p name="37ef" id="37ef" class="graf graf--p graf-after--figure">As usual, we chad devs ask the right question:</p><p name="928d" id="928d" class="graf graf--p graf-after--p"><strong class="markup--strong markup--p-strong">What problem are you trying to solve and what alternative have you considered?</strong></p><p name="40cc" id="40cc" class="graf graf--p graf-after--p">Let’s consider an alternative. Instead of observing shit, let’s use property observer.</p><pre name="8cf1" id="8cf1" class="graf graf--pre graf-after--p">var album = AlbumModel() {didSet { updateView()} }</pre><pre name="76c1" id="76c1" class="graf graf--pre graf-after--pre">var track = TrackModel() {didSet { updateView()} }</pre><pre name="3c7e" id="3c7e" class="graf graf--pre graf-after--pre">resource.post(params).onSuccess {json in /* update album, track */ }</pre><p name="53f4" id="53f4" class="graf graf--p graf-after--pre">Well, it looks viable. By the time I finish this, MVVM devs are still creating new file. Yet they say I have massive view controller problem.</p><p name="abb4" id="abb4" class="graf graf--p graf-after--p">On the other hand, what’s stopping you from sinking everything to <code class="markup--code markup--p-code">HomeViewModel</code> ? Especially when you put networking call in it. It’s just another sink object and it can still be massive. By then you would have to invent more moronic shit like nested view model to break it down. So in the end, MVVM doesn’t solve shit, create more problems, and lure you into the trap that is RxSwift.</p><h4 name="ea97" id="ea97" class="graf graf--h4 graf-after--p">Exercise</h4><p name="f337" id="f337" class="graf graf--p graf-after--h4">Rewrite linked article without MVVM and RxSwift. You will see it’s in fact <em class="markup--em markup--p-em">simpler</em>…</p><p name="65d1" id="65d1" class="graf graf--p graf-after--p">You may argue that you need a large project to understand its power. Wrong, MVVM sucks shit in large project because it doesn’t really solve shit, and it <em class="markup--em markup--p-em">prevents </em>you from solving shit because of view model and binding restrictions.</p><p name="ea6b" id="ea6b" class="graf graf--p graf-after--p graf--trailing">I hope this serves as an introduction to property observer. It’s a game changer. As a reminder, look for keywords like POP, property observer when looking for tutorials. Avoid impractical shit like MVVM or RxSwift.</p></div></div></section>
</section>
<footer><p>By <a href="https://medium.com/@swift2931" class="p-author h-card">Jim Lai</a> on <a href="https://medium.com/p/b06656904c28"><time class="dt-published" datetime="2020-10-14T08:51:04.699Z">October 14, 2020</time></a>.</p><p><a href="https://medium.com/@swift2931/impractical-mvvm-rxswift-b06656904c28" class="p-canonical">Canonical link</a></p><p>Exported from <a href="https://medium.com">Medium</a> on December 9, 2023.</p></footer></article></body></html>