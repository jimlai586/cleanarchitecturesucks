<!DOCTYPE html><html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><title>Things a MVVM tech lead never told you about</title><style>
      * {
        font-family: Georgia, Cambria, "Times New Roman", Times, serif;
      }
      html, body {
        margin: 0;
        padding: 0;
      }
      h1 {
        font-size: 50px;
        margin-bottom: 17px;
        color: #333;
      }
      h2 {
        font-size: 24px;
        line-height: 1.6;
        margin: 30px 0 0 0;
        margin-bottom: 18px;
        margin-top: 33px;
        color: #333;
      }
      h3 {
        font-size: 30px;
        margin: 10px 0 20px 0;
        color: #333;
      }
      header {
        width: 640px;
        margin: auto;
      }
      section {
        width: 640px;
        margin: auto;
      }
      section p {
        margin-bottom: 27px;
        font-size: 20px;
        line-height: 1.6;
        color: #333;
      }
      section img {
        max-width: 640px;
      }
      footer {
        padding: 0 20px;
        margin: 50px 0;
        text-align: center;
        font-size: 12px;
      }
      .aspectRatioPlaceholder {
        max-width: auto !important;
        max-height: auto !important;
      }
      .aspectRatioPlaceholder-fill {
        padding-bottom: 0 !important;
      }
      header,
      section[data-field=subtitle],
      section[data-field=description] {
        display: none;
      }
      </style></head><body><article class="h-entry">
<header>
<h1 class="p-name">Things a MVVM tech lead never told you about</h1>
</header>
<section data-field="subtitle" class="p-summary">
I was told there would be benefits
</section>
<section data-field="body" class="e-content">
<section name="08a3" class="section section--body section--first section--last"><div class="section-divider"><hr class="section-divider"></div><div class="section-content"><div class="section-inner sectionLayout--insetColumn"><h3 name="391a" id="391a" class="graf graf--h3 graf--leading graf--title">Things a MVVM tech lead never told you about</h3><figure name="9a7c" id="9a7c" class="graf graf--figure graf-after--h3"><img class="graf-image" data-image-id="1*C72plSOZocc3kGD7DCwGOQ.jpeg" data-width="500" data-height="1791" data-is-featured="true" src="https://cdn-images-1.medium.com/max/800/1*C72plSOZocc3kGD7DCwGOQ.jpeg"><figcaption class="imageCaption">Have you heard of … property observer?</figcaption></figure><h4 name="3e7a" id="3e7a" class="graf graf--h4 graf-after--figure">I was told there would be benefits</h4><p name="ca46" id="ca46" class="graf graf--p graf-after--h4">Medium daily digest decided to recommend <a href="https://blog.devgenius.io/reactive-mvvm-pattern-in-uikit-30dde1574b6b" data-href="https://blog.devgenius.io/reactive-mvvm-pattern-in-uikit-30dde1574b6b" class="markup--anchor markup--p-anchor" rel="noopener" target="_blank">this</a> article to me. It’s funny because the author who claims to be iOS tech lead all but admits that view model is boilerplate code. Quote:</p><blockquote name="1582" id="1582" class="graf graf--blockquote graf-after--p">When implemented outside of the Microsoft stack, the presence of a declarative data binding technology is what makes this pattern possible, and without a binder, one would typically use MVP or MVC instead and have to write more boilerplate (or generate it with some other tool).</blockquote><p name="aec7" id="aec7" class="graf graf--p graf-after--blockquote">Meaning: you need SDK support. Otherwise you have to write boilerplate shit.</p><p name="7d9d" id="7d9d" class="graf graf--p graf-after--p">Then he proceeds to write boilerplate shit.</p><p name="dbe2" id="dbe2" class="graf graf--p graf-after--p">Since the article is published in <em class="markup--em markup--p-em">Dev Genius.</em> Let’s tackle this as an intellectual, and do not just take his words for it. It’s not what he said, it’s what he <em class="markup--em markup--p-em">didn’t </em>say that is interesting.</p><p name="8c9c" id="8c9c" class="graf graf--p graf-after--p">For example, he didn’t say MVVM code he wrote is not boilerplate. He said you need a binder and he creates a binder. But he didn’t say you need to manually establish binding for every event for every view in every view model you created for every view controller, every time.</p><p name="b735" id="b735" class="graf graf--p graf-after--p">If you were a <em class="markup--em markup--p-em">Dev Genius</em>, MVVM without automatic binding support is the end of story. If something can be done automatically by SDK, it’s routine, it’s boilerplate. Developer time is valuable and should be allocated on activities that require creativity. You shouldn’t even allow boilerplate even if is generated by external tool. Working with boilerplate dulls your code sense. You know what activities require creativity? Not writing tools to generate boilerplate, but writing tools to avoid boilerplate. If I were <em class="markup--em markup--p-em">Dev Genius</em>, I’ll publish that article under humor category.</p><p name="5757" id="5757" class="graf graf--p graf-after--p">I&#39;ll list some other funny things that he didn’t say below. Maybe this article get to be published under humor category.</p><h4 name="d422" id="d422" class="graf graf--h4 graf-after--p">Have you heard of the tragedies of property observer?</h4><p name="7fc0" id="7fc0" class="graf graf--p graf-after--h4">It’s not a story MVVM dev would tell you.</p><p name="937a" id="937a" class="graf graf--p graf-after--p">If you want to observe a value type, the language built-in go-to is property observer. Especially when this binding is not two way. Most of time, including his examples, you are setting up for a one way event-handler.</p><figure name="5e7e" id="5e7e" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*z8QcC6XAIdgrRTWcGBytQw.png" data-width="527" data-height="93" src="https://cdn-images-1.medium.com/max/800/1*z8QcC6XAIdgrRTWcGBytQw.png"></figure><p name="0b04" id="0b04" class="graf graf--p graf-after--figure">So the first mistake is skipping property observer completely. No discussion, not even a mention.</p><p name="244d" id="244d" class="graf graf--p graf-after--p">For example, you can use a value type to control state while separating view from model (not that it’s absolutely necessary, there are ways to work with a view directly without having the problems MVVM say I’ll have)</p><pre name="3aeb" id="3aeb" class="graf graf--pre graf-after--p">// under the scope of a view controller</pre><pre name="b862" id="b862" class="graf graf--pre graf-after--pre">var btnState = false { didSet { updateUI(newValue) } }<br>// btnSearch.isEnabled = newValue in updateUI(...)</pre><pre name="78a6" id="78a6" class="graf graf--pre graf-after--pre">// in delegate callback<br>btnState = true</pre><p name="76ad" id="76ad" class="graf graf--p graf-after--pre">What’s the difference? <strong class="markup--strong markup--p-strong">That</strong>, is what a <em class="markup--em markup--p-em">Dev Genius </em>should ask<em class="markup--em markup--p-em">.</em></p><p name="7444" id="7444" class="graf graf--p graf-after--p">State change by delegate is represented by a mutation of value type. Remember you have to use reference type for view model. This is a level beyond already. There’s no value type anywhere in MVVM, which in large part has rendered MVVM obsolete.</p><p name="f63b" id="f63b" class="graf graf--p graf-after--p">Second mistake is to use implicit closure. You can’t reuse that. Guess what happens when you have another button? I hope you recognize that this is just setting up callback in an observer pattern. Where’s the event coming from? You still have to rely on SDK by setting up delegate and data sources. So work is not simplified nor reduced, it is increased now that you have to insert a middle man for an observer pattern. None of these are discussed, which if the author is a <em class="markup--em markup--p-em">Dev Genius</em>, he should. <strong class="markup--strong markup--p-strong">Comparison matters</strong>.</p><p name="4dd9" id="4dd9" class="graf graf--p graf-after--p">Imagine you have to do this in 2022, swift 5 later already, to observe a property which should be a value type. Stop copying Java.</p><figure name="b45e" id="b45e" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*Omahjz9ADcENFnAntOBNAw.png" data-width="514" data-height="187" src="https://cdn-images-1.medium.com/max/800/1*Omahjz9ADcENFnAntOBNAw.png"></figure><h4 name="253b" id="253b" class="graf graf--h4 graf-after--figure">How to couple view to binding in extension</h4><p name="a290" id="a290" class="graf graf--p graf-after--h4">He then saw the err in his way and tried to amend it.</p><figure name="3461" id="3461" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*9dJs7Fx73_l8iAc0ArEyDA.png" data-width="702" data-height="421" src="https://cdn-images-1.medium.com/max/800/1*9dJs7Fx73_l8iAc0ArEyDA.png"></figure><p name="6939" id="6939" class="graf graf--p graf-after--figure">This is the classic “if I make it look clean, then it is clean” ideology of MVVM, VIPER, Clean Architecture… etc.</p><p name="8899" id="8899" class="graf graf--p graf-after--p">So all their time is spent on organizing project hierarchy, creating new files, classes, categorizing problems without solving them. You will have 50000 classes spread over 20000 files each having 20 lines. Any implementation would be broken in 6 parts each having a manager. The assignment of managers will take up 5000 lines and is best generated by tools.</p><p name="b88b" id="b88b" class="graf graf--p graf-after--p">What this actually does, is to couple view with binding. Binding may not know about view, but view needs to know about binding! Anything can happen in callbacks of an UI element. Binding shouldn’t care about what could happen, and least of all, view. Imagine you have to look up extensions to see what this binding actually does, and more often than not it won’t be exactly what you need, so you have to add some more, which makes the next look up more difficult. You then will have problem with naming, documentation… etc. In other words, it won’t be scalable on top of being nonsensical.</p><p name="b64b" id="b64b" class="graf graf--p graf-after--p">Case and point, look at this extension.</p><figure name="9d62" id="9d62" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*1qLQUhNNLhuwN4D8mbheQQ.png" data-width="807" data-height="426" src="https://cdn-images-1.medium.com/max/800/1*1qLQUhNNLhuwN4D8mbheQQ.png"></figure><p name="c143" id="c143" class="graf graf--p graf-after--figure">The “binding” introduces a “reloadData()”, which is major side effect for a tableview. This happens under “view extension” when you create a “binding”. As a comparison, how would you go about doing this using property observer?</p><pre name="e176" id="e176" class="graf graf--pre graf-after--p">var data = [JSON]() { didSet {table.reloadData()} }</pre><p name="f66e" id="f66e" class="graf graf--p graf-after--pre">Yes I access view directly as God and UIKit intended. In UIKit, if you want to get a view reference, you can find a way to get that view reference, IBOutlet or otherwise. View model (being a reference type itself) doesn’t protect shit.</p><p name="9bd5" id="9bd5" class="graf graf--p graf-after--p">While simple, it defines a reactive response to data change. If you can manage the response in terms side effects, it’s a viable alternative. Not saying it’s the best solution, but it is a solution, and you need to at least beat this to justify additional overhead costs.</p><p name="c6fe" id="c6fe" class="graf graf--p graf-after--p">I have yet seen any MVVM article comparing with this. This is the first thing I would do if I were to convince you that these overhead costs are investments so you can have some kind of advantages.</p><h4 name="5ddb" id="5ddb" class="graf graf--h4 graf-after--p">Wrapper is boring, tedious, and signs of problem</h4><figure name="a74a" id="a74a" class="graf graf--figure graf-after--h4"><img class="graf-image" data-image-id="1*S4yWCTYlDRdU7v2d4ni7Jg.png" data-width="440" data-height="309" src="https://cdn-images-1.medium.com/max/800/1*S4yWCTYlDRdU7v2d4ni7Jg.png"></figure><p name="af28" id="af28" class="graf graf--p graf-after--figure">All these setup and this is what you bring? A “simple wrapper”.</p><p name="69db" id="69db" class="graf graf--p graf-after--p">Hint: there’s something called “computed property”.</p><p name="3d77" id="3d77" class="graf graf--p graf-after--p">E.g.;</p><pre name="4751" id="4751" class="graf graf--pre graf-after--p">extension SearchResult {<br>    var trackName: String {...}<br>}</pre><p name="1ad1" id="1ad1" class="graf graf--p graf-after--pre">If this “SearchResult” is not value type, I’ll ask why it’s not value type.</p><p name="20ef" id="20ef" class="graf graf--p graf-after--p">If this “SearchResult” is value type, then there’s no need to wrap it in reference type. In fact, the only way to share SearchResult is to have it wrapped in some reference type… So you see, MVVM asks you to do the exact opposite of what you should be doing.</p><p name="8ad1" id="8ad1" class="graf graf--p graf-after--p">And the end result, a wrapper. Remember when I said boilerplate makes you dull? If you can accept wrapper, you then will accept code-generated boilerplate, then you will think VIPER is not retarded.</p><h4 name="c759" id="c759" class="graf graf--h4 graf-after--p">The day may come when MVVM dev stop putting networking code in view model, but it is not this day</h4><figure name="6623" id="6623" class="graf graf--figure graf-after--h4"><img class="graf-image" data-image-id="1*XZdbox8Iavyqn8hfdK3EzQ.png" data-width="711" data-height="566" src="https://cdn-images-1.medium.com/max/800/1*XZdbox8Iavyqn8hfdK3EzQ.png"></figure><p name="efba" id="efba" class="graf graf--p graf-after--figure">Now imagine you work on another page that shows data from another endpoint. You have to create view model again, because underlying view is changed. You have to create bindings again because they are dependent on view. Then you have to create this same networking code again because they are not refactored out. At what point during this process do you feel joy? Do you feel like a <em class="markup--em markup--p-em">Dev Genius</em>? When will this “reusability” kick in? 80% of your codes would be <code class="markup--code markup--p-code">button.isEnabled = true</code> or <code class="markup--code markup--p-code">func loadData() {vm.loadData()}</code> or <code class="markup--code markup--p-code">var username: String {vm.view.username}</code> .</p><p name="33e6" id="33e6" class="graf graf--p graf-after--p">If you accept boilerplate, you will accept more boilerplate. Cut the middle man. Cut useless fat. Ask for comparison (which I did, with no reply, so let me compare for him). That’s how you become a <em class="markup--em markup--p-em">Dev Genius.</em></p><h4 name="f566" id="f566" class="graf graf--h4 graf-after--p">Wrap up</h4><p name="14ad" id="14ad" class="graf graf--p graf-after--h4">I’m gonna share this insight as wrap up.</p><figure name="810d" id="810d" class="graf graf--figure graf-after--p"><img class="graf-image" data-image-id="1*HsmlfZQM3wRLD2H7NiYFmg.jpeg" data-width="666" data-height="375" src="https://cdn-images-1.medium.com/max/800/1*HsmlfZQM3wRLD2H7NiYFmg.jpeg"></figure><p name="ccb3" id="ccb3" class="graf graf--p graf-after--figure">In a sense, this dude from <em class="markup--em markup--p-em">Dev Genius</em> is right. Let me quote him again:</p><blockquote name="9348" id="9348" class="graf graf--blockquote graf-after--p">without a binder, one would typically use MVP or MVC instead and have to write more boilerplate (or generate it with some other tool).</blockquote><p name="9d51" id="9d51" class="graf graf--p graf-after--blockquote">And he proved that.</p><p name="0a35" id="0a35" class="graf graf--p graf-after--p graf--trailing">Orite god damn it, stop sending me MVVM shit please medium daily digest. Can’t help but reply.</p></div></div></section>
</section>
<footer><p>By <a href="https://medium.com/@swift2931" class="p-author h-card">Jim Lai</a> on <a href="https://medium.com/p/225552239d3"><time class="dt-published" datetime="2022-04-09T08:19:33.937Z">April 9, 2022</time></a>.</p><p><a href="https://medium.com/@swift2931/things-a-mvvm-tech-lead-never-told-you-about-225552239d3" class="p-canonical">Canonical link</a></p><p>Exported from <a href="https://medium.com">Medium</a> on December 9, 2023.</p></footer></article></body></html>